b4w.register("PirateIsland_main",function(C,a){function D(a,b){b?(w.create_preloader(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},document.getElementById("main_canvas_container").children[1].style.backgroundImage="url('villatuerto_bg.png')",F.load(G+"PirateIsland.json",H,I)):console.log("b4w init failure")}function I(a){w.update_preloader(a)}function H(a,b){if(b){d=e.get_first_character();n=e.get_active_camera();k=e.get_object_by_name("CubeThrower");x=e.get_object_by_name("Tomato");
p.set("max_fps",45);p.set("max_fps_physics",500);J.append_stiff_trans_rot(k,d,[-1,0,1.2]);y.correct_up(n);z.enable_camera_controls();var E=f.create_keyboard_sensor(f.KEY_I);f.create_sensor_manifold(d,"TAKE_SCREENSHOT",f.CT_SHOT,[E],null,K);L.get_canvas().addEventListener("mousedown",M,!1);q.enable_fps_controls();q.set_cam_smooth_factor(.01);q.set_cam_sensitivity(110);N.set_day_time(4)}else console.log("b4w load failure")}function K(){O.shot();console.log("Picture taken.")}function M(){var a=A.copy(x,
"Tomato."+String(++P),!1);e.append_object(a);y.get_camera_angles(n,r);console.log("Camera angles: "+r);var b=g.get_translation(k,t),c=g.get_rotation(k,u);l.set_transform(a,t,u);g.set_rotation_v(a,u);g.rotate_x_local(a,-r[1]);l.apply_velocity(a,0,-50,0);Q(a);console.log("Thrower position: "+b[0]+", "+b[1]+", "+b[2]);console.log("Thrower rotation: "+c[0]+", "+c[1]+", "+c[2]+", "+c[3]);b=g.get_translation(d,t);console.log("Character position: "+b[0]+", "+b[1]+", "+b[2]);console.log("Click made")}function Q(a){if(l.has_physics(a)){l.enable_simulation(a);
var b=f.create_collision_sensor(a,"ANY",!0);f.create_sensor_manifold(a,"COLLISION",f.CT_CONTINUOUS,[b],function(){return!0},R)}}function R(a,b,c){if(1==c){c=m.create();m.create();var d=v.create();b=f.get_sensor_payload(a,b,0);if(null!=b.coll_obj){var h=e.get_object_by_name("TomatoSplash"),h=A.copy(h,"TomatoSplash. "+String(++S),!1);e.append_object(h);m.set_trans(b.coll_pos,c);v.rotationTo(T.AXIS_Z,b.coll_norm,d);g.set_rotation_v(h,d);m.set_quat(d,c);g.set_tsr(h,c);e.remove_object(a);console.log("Tomato collided "+
b.coll_obj.name)}else null==b.coll_obj&&console.log("Tomato collided "+b)}}var z=a("app"),p=a("config"),F=a("data"),w=a("preloader"),U=a("version"),q=a("fps"),N=a("lights"),f=a("controls"),e=a("scenes"),O=a("screenshooter"),L=a("container"),J=a("constraints"),g=a("transform"),V=a("vec3"),A=a("objects"),l=a("physics"),v=a("quat"),y=a("camera"),T=a("util"),m=a("tsr"),r=new Float32Array(2),t=V.create(),u=v.create(),d,n,k,x,P=0,S=0,B="DEBUG"==U.type(),G=p.get_assets_path("PirateIsland");C.init=function(){z.init({canvas_container_id:"main_canvas_container",
callback:D,show_fps:B,console_verbose:B,autoresize:!0})}});b4w.require("PirateIsland_main").init();
